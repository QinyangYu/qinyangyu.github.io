<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en-US' }}">
  <head>
    <meta charset="utf-8" />
    <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="description" content="{{ site.description | default: site.title }}">
    <meta name="keywords" content="{{ site.keywords }}">

    <!-- Open Graph / Twitter -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}{{ site.affiliation | prepend:' | ' }}">
    <meta property="og:url" content="{{ site.canonical }}">
    <meta property="og:site_name" content="{{ site.title }}{{ site.affiliation | prepend:' | ' }}">
    <meta property="og:description" content="{{ site.description }}">
    <meta property="og:image" content="{{ site.avatar }}">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}{{ site.affiliation | prepend:' | ' }}">
    <meta name="twitter:description" content="{{ site.description }}">
    <meta name="twitter:image" content="{{ site.avatar }}">

    <!-- Canonical & Icons -->
    <link rel="canonical" href="{{ site.canonical }}"/>
    <link rel="icon" media="(prefers-color-scheme:dark)" href="{{ site.favicon_dark }}" type="image/png" />
    <link rel="icon" media="(prefers-color-scheme:light)" href="{{ site.favicon }}" type="image/png" />

    <!-- CSS（相对路径，子页也能加载） -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/pub.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/nav.css' | relative_url }}">

    <!-- JS -->
    <script src="{{ '/assets/js/jquery.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/github-stars.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/favicon-switcher.js' | relative_url }}"></script>

    <!-- Mobile nav toggle -->
    <script>
      function myFunction() {
        var x = document.getElementById("myLinks");
        x.style.display = (x.style.display === "block") ? "none" : "block";
      }
    </script>

    <!-- 子页样式（紧凑排版 + 顶部留白） -->
    <style>
      :root { --content-width: 900px; --nav-height: 64px; }

      .page-container{
        max-width: var(--content-width);
        margin: 0 auto;
        padding: calc(var(--nav-height) + 16px) 18px 24px; /* 避免被导航遮住 */
      }

      /* 子页不显示 homepage 的头像左栏 */
      header, .wrapper > header { display: none !important; }

      /* 统一紧凑：标题/段落/列表间距（对所有子页生效） */
      .page-container h1 { margin: 0 0 10px; }
      .page-container h2,
      .page-container h3,
      .page-container h4 {
        margin-top: 16px;
        margin-bottom: 6px;   /* 标题到下一行（机构/时间）的距离更小 */
        line-height: 1.25;
      }
      .page-container p {        /* 普通段落之间的间距 */
        margin: 3px 0;
      }
      .page-container strong,
      .page-container em {
        line-height: 1.3;
      }
      .page-container ul,
      .page-container ol {
        margin: 4px 0;          /* 列表上下间距 */
        padding-left: 20px;
      }
      .page-container li {
        margin-bottom: 3px;     /* 列表项更紧凑 */
      }

      /* publication 列表（旧样式兼容） */
      .publications .pub-row { display: block; }
      .publications .col-sm-12 { width: 100%; padding-left: 0; padding-right: 0; }
      .bibliography { list-style: none; padding-left: 0; }
      .bibliography > li {
        margin: 18px 0;
        padding: 18px 20px;
        border: 1px solid #eee;
        border-radius: 12px;
        background: #fff;
      }
      .bibliography .title { font-weight: 600; font-size: 18px; line-height: 1.35; margin-bottom: 6px; }
      .bibliography .author { margin-top: 6px; color: #555; }
      .bibliography .periodical { margin-top: 6px; color: #666; }
      .bibliography .abbr .badge { font-size: 11px; padding: 3px 6px; border-radius: 6px; background: #f1f3f5; color: #444; }
      .bibliography .links a { margin-right: 8px; margin-top: 6px; display: inline-block; }
    </style>
  </head>

  <body>
    <!-- 顶部导航：不显示 affiliation 图标 -->
    <div class="topnav">
      <div id="myLinks">
        {% include navigation.md %}
      </div>
      <a href="javascript:void(0);" class="icon" onclick="myFunction()">
        <i class="fa fa-bars"></i>
      </a>
    </div>

    <!-- 返回顶部（可选） -->
    <script src="{{ '/assets/js/vanilla-back-to-top.min.js' | relative_url }}"></script>
    <script>
      if (typeof addBackToTop === 'function') {
        addBackToTop({ backgroundColor: '#fff', innerHTML: 'Back to Top', textColor: '#333' });
      }
    </script>
    <style>
      #back-to-top {
        border:1px solid #ccc;
        border-radius:0;
        font-size:15px;
        width:100px;
        text-align:center;
        line-height:30px;
        height:30px;
      }
    </style>

    <!-- 正文容器 -->
    <main class="page-container">
      {{ content }}

      {% if site.enable_last_update %}
      <br>
      <small>Last Update:
        <script>
          (function(){
            var m=["January","Februray","March","April","May","June","July","August","September","October","November","December"];
            var d=new Date(document.lastModified);
            document.write(d.getDate()+". "+m[d.getMonth()]+" "+d.getFullYear());
          })();
        </script>
      </small>
      {% endif %}

      {% if site.footnote %}
      <div style="font:12px/1.2 Crimson Pro, serif; margin-top:8px;">
        <a href="{{ site.footnote_link }}" rel="noopener">{{ site.footnote }}</a>
      </div>
      {% endif %}

      {% if site.clustrmaps_id %}
      <div style="width:300px; pointer-events: none; margin-top:10px;">
        <script type="text/javascript" id="clstr_globe" src="//clustrmaps.com/globe.js?d={{ site.clustrmaps_id }}"></script>
      </div>
      {% endif %}
    </main>

    <footer>
      <div style="font:12px/1.2 Crimson Pro, serif; text-align:center; padding:20px 0;">
        <small>
          {% if site.imprint %}
            <a href="{{ site.imprint }}" rel="noopener"><autocolor>Imprint / Impressum</autocololr></a><br>
          {% endif %}
          {% if site.data_protection %}
            <a href="{{ site.data_protection }}" rel="noopener"><autocolor>Data Protection / Datenschutzhinweis</autocolor></a>
          {% endif %}
        </small>
      </div>
    </footer>

    <script src="{{ '/assets/js/scale.fix.js' | relative_url }}"></script>
  </body>
</html>
