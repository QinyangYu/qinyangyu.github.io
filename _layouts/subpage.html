<!DOCTYPE html>
<html lang="{{ site.lang | default: 'en-US' }}">
  <head>
    <meta charset="utf-8" />
    <title>{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <meta name="description" content="{{ site.description | default: site.title }}">
    <meta name="keywords" content="{{ site.keywords }}">

    <!-- Open Graph / Twitter -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}{{ site.affiliation | prepend:' | ' }}">
    <meta property="og:url" content="{{ site.canonical }}">
    <meta property="og:site_name" content="{{ site.title }}{{ site.affiliation | prepend:' | ' }}">
    <meta property="og:description" content="{{ site.description }}">
    <meta property="og:image" content="{{ site.avatar }}">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="{% if page.title %}{{ page.title }} | {% endif %}{{ site.title }}{{ site.affiliation | prepend:' | ' }}">
    <meta name="twitter:description" content="{{ site.description }}">
    <meta name="twitter:image" content="{{ site.avatar }}">

    <!-- Canonical & Icons -->
    <link rel="canonical" href="{{ site.canonical }}"/>
    <link rel="icon" media="(prefers-color-scheme:dark)" href="{{ site.favicon_dark }}" type="image/png" />
    <link rel="icon" media="(prefers-color-scheme:light)" href="{{ site.favicon }}" type="image/png" />

    <!-- CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/pub.css' | relative_url }}">
    <link rel="stylesheet" href="{{ '/assets/css/nav.css' | relative_url }}">

    <!-- JS -->
    <script src="{{ '/assets/js/jquery.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/github-stars.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/favicon-switcher.js' | relative_url }}"></script>

    <!-- Mobile nav toggle -->
    <script>
      function myFunction() {
        var x = document.getElementById("myLinks");
        x.style.display = (x.style.display === "block") ? "none" : "block";
      }
    </script>

    <!-- 子页样式 -->
    <style>
      :root { --content-width: 900px; --nav-height: 64px; }

      .page-container{
        max-width: var(--content-width);
        margin: 0 auto;
        padding: calc(var(--nav-height) + 12px) 18px 24px; /* 顶部避免被遮 */
      }

      /* 去掉 homepage 的头像/左栏 */
      header, .wrapper > header { display: none !important; }

      /* 避免标题再顶上去 */
      .page-container h1:first-child { margin-top: 0; }

      /* ---- 紧凑化 ---- */
      .page-container h2, .page-container h3, .page-container h4 {
        margin-top: 16px;
        margin-bottom: 4px;
      }
      .page-container p {
        margin: 2px 0;
      }
      .page-container ul, .page-container ol {
        margin-top: 2px;
        margin-bottom: 2px;
        padding-left: 20px;
      }
      .page-container li {
        margin-bottom: 3px;
      }

      /* publication 列表修正 */
      .publications .pub-row { display: block; }
      .publications .col-sm-12 { width: 100%; padding-left: 0; padding-right: 0; }

      .bibliography { list-style: none; padding-left: 0; }
      .bibliography > li {
        margin: 14px 0;
        padding: 14px 16px;
        border: 1px solid #eee;
        border-radius: 10px;
        background: #fff;
      }
      .bibliography .title { font-weight: 600; font-size: 18px; line-height: 1.35; margin-bottom: 4px; }
      .bibliography .author { margin-top: 3px; color: #555; }
      .bibliography .periodical { margin-top: 3px; color: #666; }
      .bibliography .abbr .badge { font-size: 11px; padding: 2px 5px; border-radius: 6px; background: #f1f3f5; color: #444; }
      .bibliography .links a { margin-right: 6px; margin-top: 4px; display: inline-block; }
    </style>
  </head>

  <body>
    <!-- 顶部导航（已去掉 affiliation 图标） -->
    <div class="topnav">
      <div id="myLinks">
        {% include navigation.md %}
      </div>
      <a href="javascript:void(0);" class="icon" onclick="myFunction()">
        <i class="fa fa-bars"></i>
      </a>
    </div>

    <!-- 正文容器 -->
    <main class="page-container">
      {{ content }}

      {% if site.enable_last_update %}
      <br>
      <small>Last Update:
        <script>
          (function(){
            var m=["January","Februray","March","April","May","June","July","August","September","October","November","December"];
            var d=new Date(document.lastModified);
            document.write(d.getDate()+". "+m[d.getMonth()]+" "+d.getFullYear());
          })();
        </script>
      </small>
      {% endif %}

      {% if site.footnote %}
      <div style="font:12px/1.2 Crimson Pro, serif; margin-top:8px;">
        <a href="{{ site.footnote_link }}" rel="noopener">{{ site.footnote }}</a>
      </div>
      {% endif %}

      {% if site.clustrmaps_id %}
      <div style="width:300px; pointer-events: none; margin-top:10px;">
        <script type="text/javascript" id="clstr_globe" src="//clustrmaps.com/globe.js?d={{ site.clustrmaps_id }}"></script>
      </div>
      {% endif %}
    </main>

    <footer>
      <div style="font:12px/1.2 Crimson Pro, serif; text-align:center; padding:20px 0;">
        <small>
          {% if site.imprint %}
            <a href="{{ site.imprint }}" rel="noopener"><autocolor>Imprint / Impressum</autocolor></a><br>
          {% endif %}
          {% if site.data_protection %}
            <a href="{{ site.data_protection }}" rel="noopener"><autocolor>Data Protection / Datenschutzhinweis</autocolor></a>
          {% endif %}
        </small>
      </div>
    </footer>

    <script src="{{ '/assets/js/scale.fix.js' | relative_url }}"></script>
  </body>
</html>
